# 行政区划数据

市面上已经有很多三级联动的行政区划选择组件，其中一部分虽时间久远但仍能正常运作，却迫于数据源没有得到及时更新而不得不被替换，造成巨大的浪费。

## 目标

1. 建立一个满足 90% 核心需求的行政区划数据源。
2. 通过屏蔽一些需求来降低实现的难度，从而保证项目可以得到持续维护。
3. 通过固定算法从初始数据源生成多种格式，每次初始数据源更新时，只要重新计算一次便可生成对应格式。
4. 通过生成与旧组建兼容的数据格式帮助它们重新焕发生机。

## 不做什么

1. 四级联动，也就是县级以下的行政区划数据
2. 直筒子市下的镇，这里单独说明一下，不少三级联动的里把它们作为第三级进行选择，但在行政区划上，这些镇其实是第四级，未出现在民政局的数据源中
3. 港澳台的详细数据，未出现在民政局的数据源中

## 数据来源

初始数据来自民政局每年一次发布的，截止上一年度的：中华人民共和国县以上行政区划代码。
目前最新数据源 [2018 年中华人民共和国县以上行政区划代码（截止 2018 年 12 月 31 日）](http://www.mca.gov.cn/article/sj/xzqh/1980/201903/201903011447.html)

我设置了每月一次的日历提醒来检查民政局网站是否更新。

## 背景知识

### 数字代码编码规则

数字代码采用三层六位层次码结构，代码从左至右的含义是：

第一层（第一、二位）表示省级行政区（省、自治区、直辖市、特别行政区），其中第一位代表大区。
第二层（第三、四位）表示地级行政区（地级市、地区、自治州、盟），直辖市的市辖区、县的汇总码，及省（自治区）直辖县级行政区的汇总码。
第三层（第五、六位）表示县级行政区（县、自治县、市辖区、县级市、旗、自治旗、林区、特区）。

来源：[维基百科上关于中华人民共和国行政区划代码规则的介绍](https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%8D%8E%E4%BA%BA%E6%B0%91%E5%85%B1%E5%92%8C%E5%9B%BD%E8%A1%8C%E6%94%BF%E5%8C%BA%E5%88%92%E4%BB%A3%E7%A0%81)

### 行政区划架构与特殊情况的说明

整体上按照省市区的三级结构，但有部分地区的数据需要特殊处理

### 直辖市和特别行政区

直辖市和特别行政区只有第一和第三级。
如 `北京市->东城区` 。
数据处理上如有需要，会添加虚拟的第二级。如 `北京市->东城区`，许多组件会处理成 `北京市->市辖区->东城区` 以保持一致的三级选择。
其中又以重庆最为特殊，第二级分为 `市辖区` 和 `县` 两类（行政区划编码中间两位分别为 `01` 和 `02`）。

### 省直辖县级行政区

省直辖县级行政区是指行政事务直接受省级行政区政府直接领导和管辖的县级行政区。
如 `湖北省->仙桃市` 。
这些地区属于第三级的县级行政区（行政编码中间两位为 `90`），但是由省直接管辖，中间没有第二级。
如果要符合三级选项，可以通过添加虚拟的第二级 `省直辖` 处理成 `湖北省->省直辖->仙桃市` 。

来源：[维基百科上关于省直辖县级行政区的介绍](https://zh.wikipedia.org/wiki/%E7%9C%81%E7%9B%B4%E8%BE%96%E5%8E%BF%E7%BA%A7%E8%A1%8C%E6%94%BF%E5%8C%BA)

### 直筒子市

直筒子市，是指中华人民共和国的建制市中，其内部不设立市辖区的地级市。
如 `广东省->中山市` 。
这些地区属于第二级行政区，但下属区域不是第三级的县级行政区而是第四级。
第四级区域的数据不在初始数据源中。但不满足三级选项可能导致部分要求必填的组件无法运作，针对这种情况，通过重复第二级作为虚拟的第三级，如：`广东省->中山市->中山市`

## 输出格式与命名

目前支持下列格式：CSV、JSON、SQL

命名规则：`[origin|[parent|tree]-[dynamic|fixed]].[csv|json|sql]`

- origin 只包含原始数据，适用于 csv, json, sql
- parent 在子级中包含父级数据，适用于 csv, json, sql
- tree 在父级中嵌套子集数据，适用于 json
- dynamic 动态级别，按实际的行政区划关系建立上下级关联
- fixed 固定三级，通过添加虚拟的第二、第三级满足三级关系
